<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chaos - Error Simulation</title>
    <style>
        button {
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }
        .error-log {
            color: red;
        }
    </style>
    <script>
        (function(n,i,v,r,s,c,x,z){x=window.AwsRumClient={q:[],n:n,i:i,v:v,r:r,c:c};window[n]=function(c,p){x.q.push({c:c,p:p});};z=document.createElement('script');z.async=true;z.src=s;document.head.insertBefore(z,document.head.getElementsByTagName('script')[0]);})(
            'cwr',
            '10b40b72-f750-4f1b-8900-1e2005ae7b26',
            '1.0.0',
            'us-east-1',
            'https://client.rum.us-east-1.amazonaws.com/1.18.0/cwr.js',
            {
                sessionSampleRate: 1,
                identityPoolId: "us-east-1:037dc4f6-056f-47b4-a9be-1dbeb882c144",
                endpoint: "https://dataplane.rum.us-east-1.amazonaws.com",
                telemetries: ["performance","errors","http"],
                allowCookies: true,
                enableXRay: true
            }
        );

        // Global error handler to catch uncaught errors
        window.onerror = function(message, source, lineno, colno, error) {
            console.error(`Error: ${message} at ${source}:${lineno}:${colno}`);
            const errorLog = document.getElementById('error-log');
            errorLog.innerHTML += `<p class="error-log">Caught error: ${message} (Line: ${lineno}, Col: ${colno})</p>`;
            return true;  // Prevent default browser error handling
        };

        // Trigger a ReferenceError (undefined variable)
        function triggerReferenceError() {
            alert(nonExistentVariable);
        }

        // Trigger a TypeError (invalid method call)
        function triggerTypeError() {
            null.f();  // Cannot call a method on `null`
        }

        // Trigger a SyntaxError (intentional bad syntax)
        function triggerSyntaxError() {
            eval('var a = );');  // Incorrect syntax
        }

        // Trigger an out of memory error (intentionally)
        function triggerOutOfMemoryError() {
            let memoryHog = [];
            while (true) {
                memoryHog.push(new Array(1000000).fill(0));  // Continuously allocate large arrays
            }
        }

        // Trigger an infinite loop (high CPU usage simulation)
        function triggerInfiniteLoop() {
            while (true) {
                console.log('This will keep logging forever until the browser hangs...');
            }
        }

        // Simulate a network failure (non-existent resource)
        function triggerNetworkFailure() {
            fetch('https://example.com/non-existent')
                .then(response => response.json())
                .catch(error => {
                    console.error('Network error occurred:', error.message);
                    const errorLog = document.getElementById('error-log');
                    errorLog.innerHTML += `<p class="error-log">Network error: ${error.message}</p>`;
                });
        }

        // Simulate an HTTP 404 Not Found error
        function trigger404Error() {
            fetch('/api/non-existent-endpoint')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('404 Not Found');
                    }
                })
                .catch(error => {
                    console.error('404 error occurred:', error.message);
                    const errorLog = document.getElementById('error-log');
                    errorLog.innerHTML += `<p class="error-log">404 error: ${error.message}</p>`;
                });
        }

        // Simulate an HTTP 500 Internal Server Error
        function trigger500Error() {
            fetch('/api/server-error')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('500 Internal Server Error');
                    }
                })
                .catch(error => {
                    console.error('500 error occurred:', error.message);
                    const errorLog = document.getElementById('error-log');
                    errorLog.innerHTML += `<p class="error-log">500 error: ${error.message}</p>`;
                });
        }

        // Simulate a network timeout
        function triggerTimeoutError() {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 5000);  // Timeout after 5 seconds

            fetch('https://example.com/slow-resource', { signal: controller.signal })
                .then(response => response.json())
                .catch(error => {
                    if (error.name === 'AbortError') {
                        console.error('Timeout error occurred:', error.message);
                        const errorLog = document.getElementById('error-log');
                        errorLog.innerHTML += `<p class="error-log">Timeout error: Request took too long</p>`;
                    }
                });
        }

        // Simulate a CORS error (cross-origin resource sharing error)
        function triggerCORSError() {
            fetch('https://another-domain.com/resource')
                .then(response => response.json())
                .catch(error => {
                    console.error('CORS error occurred:', error.message);
                    const errorLog = document.getElementById('error-log');
                    errorLog.innerHTML += `<p class="error-log">CORS error: ${error.message}</p>`;
                });
        }
    </script>
</head>
<body>
<h1>Chaos - JavaScript and Network Error Simulation</h1>
<p>Click the buttons below to simulate different types of JavaScript and network errors.</p>

<!-- Buttons to trigger different JavaScript errors -->
<button onclick="triggerReferenceError()">Trigger ReferenceError</button>
<button onclick="triggerTypeError()">Trigger TypeError</button>
<button onclick="triggerSyntaxError()">Trigger SyntaxError</button>
<button onclick="triggerOutOfMemoryError()">Trigger Out of Memory Error</button>
<button onclick="triggerInfiniteLoop()">Trigger Infinite Loop (CPU Chaos)</button>

<!-- Buttons to trigger network/HTTP errors -->
<button onclick="triggerNetworkFailure()">Trigger Network Failure</button>
<button onclick="trigger404Error()">Trigger 404 Not Found Error</button>
<button onclick="trigger500Error()">Trigger 500 Internal Server Error</button>
<button onclick="triggerTimeoutError()">Trigger Timeout Error</button>
<button onclick="triggerCORSError()">Trigger CORS Error</button>

<!-- Error log to display caught errors -->
<div id="error-log"></div>
</body>
</html>
